-- Criação do Banco de Dados
USE livraria_jeferson;
CREATE DATABASE IF NOT EXISTS livraria;


--Tabela de Autores
USE livraria_jeferson;

CREATE TABLE IF NOT EXISTS Autores (
    AutorID INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL,
    Nacionalidade VARCHAR(50)
);

-- Crie a tabela Livros
USE livraria_jeferson;

CREATE TABLE IF NOT EXISTS Livros (
    LivroID INT PRIMARY KEY AUTO_INCREMENT,
    Titulo VARCHAR(200) NOT NULL,
    Genero VARCHAR(50),
    AnoPublicacao INT,
    AutorID INT,
    FOREIGN KEY (AutorID) REFERENCES Autores(AutorID)
);

-- Tabela de Clientes
USE livraria_jeferson;

CREATE TABLE IF NOT EXISTS Clientes (
    ClienteID INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL,
    Endereco VARCHAR(200),
    Telefone VARCHAR(15)
);

-- Tabela de Empréstimos
USE livraria_jeferson;

CREATE TABLE IF NOT EXISTS Emprestimos (
    EmprestimoID INT PRIMARY KEY AUTO_INCREMENT,
    LivroID INT,
    ClienteID INT,
    DataEmprestimo DATE,
    DataDevolucao DATE,
    FOREIGN KEY (LivroID) REFERENCES Livros(LivroID),
    FOREIGN KEY (ClienteID) REFERENCES Clientes(ClienteID)
);

-- Inserção de Dados
USE livraria_jeferson;

INSERT IGNORE INTO Autores (AutorID, Nome, Nacionalidade) VALUES 
(1, 'Robert Kiyosaki e Sharon Lechter', 'Havaí'),
(2, 'Sun Tzu', 'China'),
(3, 'Napoleon Hill ', 'Virgínia, EUA');

INSERT IGNORE INTO Livros (LivroID, Titulo, Genero, AnoPublicacao, AutorID) VALUES 
(1, 'Pai Rico, Pai Pobre', 'Finanças', 1997, 1),
(2, 'A arte da Guerra', 'Estratégia', 1972, 2),
(3, 'O homem que enganou o Diabo', 'Autoajuda', 1980, 3);

INSERT IGNORE INTO Clientes (ClienteID, Nome, Endereco, Telefone) VALUES 
(1, 'Jeferso', 'Rua Canarío, 123', '9999-9999'),
(2, 'Helena', 'Rua Pardal, 456', '8888-8888'),
(3, 'Talita', 'Rua Cardial, 789', '7777-7777');

-- Alteração das Tabelas
-- Tabela de Autores
USE livraria_jeferson;

ALTER TABLE Autores ADD COLUMN DataNascimento DATE, ADD COLUMN Biografia TEXT;

-- Tabela de Livros
USE livraria_jeferson;

ALTER TABLE Livros ADD COLUMN Editora VARCHAR(100), ADD COLUMN NumeroPaginas INT, ADD COLUMN Idioma VARCHAR(50);

-- Tabela de Clientes
USE livraria_jeferson;

 ALTER TABLE Clientes ADD COLUMN Email VARCHAR(100), ADD COLUMN DataNascimento DATE;

--Tabela de Empréstimos
USE livraria_jeferson;

ALTER TABLE Emprestimos ADD COLUMN DataPrevistaDevolucao DATE, ADD COLUMN Status VARCHAR(20);

-- Inserção de Dados nas Novas Colunas
USE livraria_jeferson;

UPDATE Autores SET DataNascimento = '1997-04-23', Biografia = 'Robert Kiyosaki e Sharon Lechter, criadores do livro.' WHERE AutorID = 1;

USE livraria_jeferson;
UPDATE Livros SET Editora = 'Editora Record', NumeroPaginas = 234, Idioma = 'Português' WHERE LivroID = 1;

USE livraria_jeferson;
UPDATE Clientes SET Email = 'jeferson@mail.com', DataNascimento = '1988-02-21' WHERE ClienteID = 1;
USE livraria_jeferson;
UPDATE Clientes SET Email = 'helena@mail.com', DataNascimento = '2016-06-16' WHERE ClienteID = 2;
USE livraria_jeferson;
UPDATE Clientes SET Email = 'talita@mail.com', DataNascimento = '1985-08-22' WHERE ClienteID = 3;

USE livraria_jeferson;
UPDATE Emprestimos SET DataPrevistaDevolucao = '2024-07-25', Status = 'Em andamento' WHERE EmprestimoID = 1;
USE livraria_jeferson;
UPDATE Emprestimos SET DataPrevistaDevolucao = '2024-07-28', Status = 'Em andamento' WHERE EmprestimoID = 2;
USE livraria_jeferson;
UPDATE Emprestimos SET DataPrevistaDevolucao = '2024-07-30', Status = 'Em andamento' WHERE EmprestimoID = 3;
